# AI 旅行规划师产品文档

## 产品概述
AI 旅行规划师是一款 Web 应用，旨在简化旅行规划过程。通过 AI 理解用户需求，自动生成详细的旅行路线和建议，并提供实时旅行辅助。

---

## 1. 智能行程规划

### 1.1 输入方式
- **语音输入**（必须实现）：用户可通过语音输入旅行需求
- **文字输入**：支持文字输入作为补充方式

### 1.2 输入内容
用户可能提供以下信息，但不强制：
- **旅行目的地**：具体的城市或国家
- **旅行日期**：开始日期和结束日期（天数）
- **预算金额**：总预算或每日预算
- **同行人数**：人数及人员组成（如是否带孩子、老人等）
- **旅行偏好**：个人兴趣和偏好
  - 明确的地点
  - 兴趣类型（美食、历史、自然、购物、动漫、艺术等）
  - 节奏偏好（休闲、紧凑、适中）
  - 特殊需求（无障碍设施、素食餐厅等）

**输入示例**："我想去日本，5天，预算1万元，喜欢美食和动漫，带孩子"

### 1.3 AI 生成行程的内容
系统通过 LLM 生成完整的个性化旅行计划，包括：
- **交通安排**：往返交通方式、城市间交通、市内交通建议
- **住宿推荐**：酒店或民宿推荐（考虑预算和位置）
- **景点安排**：每日主要景点（2-4个），符合用户偏好
- **餐饮推荐**：早中晚餐推荐，匹配用户美食偏好
- **时间规划**：每日详细时间表，合理安排行程节奏

### 1.4 行程结构
- **以天为单位**：每天作为一个规划单元
- **主要事件**：每天2～4个必完成的主要事件（景点、餐饮、娱乐）
- **附属事件**：每个主要事件关联1～3个可顺带完成的小事件
- **时间展现**：按时间先后顺序，大事件附带小事件的形式展现

### 1.5 实现逻辑
1. **用户输入处理**：
   - 语音输入通过语音识别 API 转换为文字
   - 文字输入
   - 整合用户输入的所有信息
   
2. **LLM 生成初步规划**：
   - 根据用户需求，生成每日主要事件安排
   - 考虑硬性条件（日期、预算、人数、偏好）
   - 生成交通和住宿建议
   
3. **地点验证**：
   - 使用高德地图 API 确认地点是否真实存在
   - 若地点不存在则直接从行程中删除
   
4. **周边推荐生成**：
   - 通过高德地图 API 获取每个主要事件周围的 POI（餐饮、娱乐、景点）
   - 检索附近 5-10 个相关地点
   
5. **附属事件筛选**：
   - LLM 从周边地点中选择 1～3 个适合顺带完成的小事件
   - 考虑距离、时间、用户偏好等因素

### 1.6 支持的交互形式
- **单轮对话**：用户一次性输入完整需求，系统生成完整行程
- **结果展示**：清晰的时间线展示，地图标注所有地点

---

## 2. 费用预算

### 2.1 AI 预算分析
- **自动预算估算**：
  - 根据目的地、天数、人数，LLM 自动估算各项费用
  - 费用分类：交通费、住宿费、餐饮费、门票费、其他费用
  - 提供预算建议和优化方案
  
- **预算分配建议**：
  - 各项费用占比分析
  - 根据用户总预算进行合理分配
  - 标注预算充裕度（宽裕/适中/紧张）

---

## 3. 地图与交互

### 3.1 地图核心功能
- **地图为主的交互界面**：页面以地图为核心展示元素
- **地图引擎**：使用高德地图 JS API
- **地点标注**：所有行程中的地点在地图上清晰标注
- **路线展示**：显示景点之间的路线和距离

### 3.2 地图交互
- **自由浏览**：
  - 地图可任意拖动、缩放
  - 支持定位到当前位置
  
- **地点跳转**：
  - 点击行程中的事件，地图平滑移动到目标位置
  - 从当前中心点连贯动画移动至目标地点
  
- **地图标记**：
  - 可在地图上添加自定义标记
  - 每个行程的标记独立管理
  - 支持删除标记

### 3.3 通过地图管理行程
- **地图选点添加**：在地图上点击地点，添加到行程中
- **地图删除事件**：在地图标记上操作删除事件
- **地点搜索**：支持在地图上搜索地点并添加到行程

---

## 4. 行程管理

### 4.1 行程编辑
- **手动添加事件**：
  - 用户可添加景点、餐厅、娱乐活动等事件
  - 输入地点名称，系统通过高德 API 搜索并确认
  - 若地点找不到，地图提示"无法定位该地点"
  
- **删除事件**：
  - 可删除行程中的任意事件
  - 删除主要事件时，附属事件一同删除或提示用户处理
  
- **调整顺序**：
  - 支持拖拽调整事件顺序
  - 系统自动重新计算路线和时间

### 4.2 多行程管理
- **创建行程**：
  - 用户可创建多个行程计划
  - 每个行程独立命名和管理
  
- **删除行程**：
  - 可删除不需要的行程
  - 删除前二次确认
  
- **行程切换**：
  - 快速在多个行程间切换查看
  - 当前选中行程高亮显示

### 4.3 行程展示
- **时间线视图**：按时间顺序展示行程
- **地图视图**：在地图上展示所有地点
- **列表视图**：清晰的列表形式，便于阅读和编辑

---

## 5. 用户管理与数据存储

### 5.1 注册登录系统
- **用户注册**：
  - 邮箱注册
  
- **用户登录**：
  - 邮箱密码登录
  - 记住登录状态
  
- **密码管理**：
  - 修改密码
  - 忘记密码找回

### 5.2 云端数据同步
- **自动同步**：
  - 行程计划自动保存到云端

### 5.3 用户偏好管理
- **保存用户偏好**：
  - 常用旅行偏好设置
  - 预算范围偏好
  - 常用出发地
  
- **历史记录**：
  - 保存历史行程
  - 可查看和复用历史行程

---

## 6. UI/UX 设计要求

### 6.1 界面布局
- **地图为主**：地图占据主要视觉区域
- **侧边栏或浮层**：展示行程详情、费用信息等
- **响应式设计**：适配不同屏幕尺寸

### 6.2 视觉设计
- **美观的图片**：
  - 景点配图美观清晰
  - 使用高质量的旅游图片
  - 图片与地点相关联
  
- **现代化 UI**：
  - 简洁美观的界面设计
  - 流畅的动画效果
  - 舒适的配色方案

### 6.3 交互体验
- **清晰的行程展示**：
  - 信息层次分明
  - 重点信息突出
  - 易于阅读和理解
  
- **流畅的操作**：
  - 操作反馈及时
  - 加载状态清晰提示
  - 错误信息友好提示

---

## 7. 系统配置与安全

### 7.1 API Key 管理
- **安全要求**：
  - **严禁将任何 API Key 硬编码在代码中**
  - **不得将 API Key 提交到 GitHub 公开代码库**
  
- **配置方式**：
  - 使用 `.env` 文件存储 API Key
  - `.env` 文件加入 `.gitignore`
  - 提供 `.env.example` 模板文件

### 7.2 需要的 API Key
- **语音识别 API**：科大讯飞或其他语音识别服务
- **地图 API**：高德地图 Web 服务 API Key 和 JS API Key
- **LLM API**：用于行程规划和预算分析，deepseek
- **数据库服务**：Supabase 的配置密钥

---

## 8. 未来迭代方向（暂不实现）

### 8.1 多轮对话优化
- 用户可以与 AI 多轮对话，逐步优化行程方案
- AI 可以针对用户反馈调整建议

### 8.2 天气集成
- 实时天气预报
- 根据天气调整行程建议

### 8.3 社交功能
- 分享行程给好友
- 查看他人的公开行程
- 行程评价和反馈